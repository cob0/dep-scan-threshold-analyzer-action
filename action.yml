name: "dep-scan-threshold-analyzer"
description: "A binary tool that verifies if vulnerability reports generated by dep-scan comply with predefined security thresholds. It outputs OK if the vulnerabilities are within the threshold or FAIL if they exceed the allowed values."
inputs:
  report_file:
    description: "Specifies the filepath where the report are stored."
    required: false
    default: "/github/workspace/reports/sbom-universal.vdr.json"
  threshold:
    description: "Defines the threshold level used to determine when a vulnerability or issue should be considered a failure."
    required: false
    default: "5.0"

runs:
  using: "docker"
  image: "docker://ghcr.io/cob0/dep-scan-threshold-analyzer:1.0.0-rc"
  args:
    - "dep_scan_threshold_analyzer.py"
    - "-f"
    - ${{ inputs.report_file }}
    - "-t"
    - ${{ inputs.threshold }}
branding:
  icon: "shield"
  color: "green"
